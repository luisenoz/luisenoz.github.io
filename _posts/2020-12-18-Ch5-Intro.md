# CHAPTER 5.1: IMAGE CLASSIFICATION

To make your model really work, and work reliably, there are a lot of details you have to get right, 
and a lot of details that you have to check.     
This process requires being able to look inside your neural network as it trains and as it makes predictions, 
find possible problems, and know how to fix them.

We'll need to do a deep dive into the mechanics of deep learning. 
- What is the architecture of a computer vision model, 
 - an NLP model, 
 - a tabular model, and others.
 - How do we create an architecture that matches the needs of our particular domain
 - How do we get the best possible results from the training process 
 - How do we make things faster
 - What do we have to change as our datasets change.
 
 We will start by repeating the same basic applications that we looked at in the first chapter, but we are going to do two things: 
 - Make them better.  
 - Apply them to a wider variety of types of data.

## FROM DOGS AND CATS TO PET BREEDES

The same dataset we used to identify cats from dogs will also allow us to work on a much more challenging problem:     
**figuring out what breed of pet is shown in each image.**

In real life, we'll normally start with a dataset that we don't know anything about. We then have to figure out:
= how it is put together, 
- how to extract the data we need from it, 
- and what that data looks like.

We already downloaded the Pets dataset, and we can get a path to this dataset using the same code as in Chapter 1: 
```python
from fastai.vision.all import *
path = untar_data(URLs.PETS)
```

Now, to be able to extract the breed of each pet, we'll need to understand how the data is laid out.     
Data is usually provided in one of these two ways: 
- Individual files representing items of data, possibly organized into folders or with filenames representing information about those items  
- A table of data (e.g., in CSV format) in which each row is an item and may include filenames providing connections between the data in the table 
and data in other formats, such as text documents and images.

To see what is in our dataset, we can use the *ls* method: 
```python
path.ls() 
```
(#3) [Path('annotations'),Path('images'),Path('models')]

The *annotations* directory contains information about where the pets are. 
Since we'll be doing classification, not localization, we will ignore the *annotations* directory.     
We can use the same *ls* method to se what's inside the *images* folder:
```python
(path/'images').ls()
```

(#7394) [Path('images/great_pyrenees_173.jpg'),Path('images/wheaten_terrier_46.jpg'),
Path('images/Ragdoll_262.jpg'),Path('images/german_shorthaired_3.jpg'),
Path('images/american_bulldog_196.jpg'),Path('images/boxer_188.jpg'),
Path('images/staffordshire_bull_terrier_173.jpg'),Path('images/basset_hound_71.jpg'),
Path('images/staffordshire_bull_terrier_37.jpg'),Path('images/yorkshire_terrier_18.jpg')...].    

The first thing that is shown is the number of items in the collection, prefixed with a *#*, and only the first few items are displayed.

We can see that each file name is structured as follows:
1. the pet breed,
2. then an underscore (_),
3. a number,
4. the file extension (.jpg)

We need to create a piece of code that extracts the breed from a single Path, and the use it for the whole dataset.     
To allow us to test our code, let’s pick out one of these filenames: 
```python
fname = (path/"images").ls()[0]
```
The authors suggest that the most powerful and flexible way to extract information from strings like this is to use a **regular expressions**, 
also known as a ***regex***. A regular expression is a special string, written in the regular expression language, 
which specifies a general rule for deciding whether another string passes a test (i.e., “matches” the regular expression), 
and also possibly for plucking a particular part or parts out of that other string.

> Since Jeremy so highly talks about *regex* and name them as one of the most useful tools in our programming toolkit 
that many of his students find it is one of the things they are most excited to learn about, I included here a notebook that could give you a good idea 
about how to work with regular expression, if you're not used to them. [regex notebook](https://github.com/luisenoz/luisenoz.github.io/blob/master/images/RegEx.ipynb)






